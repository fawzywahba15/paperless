<div class="container mt-4 mb-5">
  <a routerLink="/documents" class="text-decoration-none text-muted mb-3 d-inline-block">
    <i class="bi bi-arrow-left"></i> Zurück zur Übersicht
  </a>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div *ngIf="!isLoading && document" class="row">

    <div class="col-md-4 mb-4">
      <div class="card shadow-sm border-0 sticky-top" style="top: 20px; z-index: 1;">
        <div class="card-body text-center pt-5 pb-4">
          <div class="bg-light d-inline-flex p-3 rounded-circle mb-3 text-danger shadow-sm">
            <i class="bi bi-file-earmark-pdf display-4"></i>
          </div>
          <h1 class="h4 card-title text-break mb-1">{{ document.title }}</h1>
          <p class="text-muted small">{{ document.filename }}</p>

          <button class="btn btn-primary w-100 mt-3" (click)="downloadFile()">
            <i class="bi bi-download me-2"></i> Download PDF
          </button>
        </div>
        <div class="card-footer bg-white">
          <div class="d-flex justify-content-between py-2 border-bottom">
            <span class="text-muted small">Status</span>
            <span class="badge bg-success">{{ document.status }}</span>
          </div>
          <div class="d-flex justify-content-between py-2">
            <span class="text-muted small">Größe</span>
            <span class="small fw-bold">{{ document.size }} Bytes</span>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-8">
      <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-bottom-0 pt-3 ps-3">
          <ul class="nav nav-tabs card-header-tabs">
            <li class="nav-item">
              <button class="nav-link"
                      [class.active]="activeTab === 'summary'"
                      (click)="activeTab = 'summary'">
                <i class="bi bi-stars text-warning me-2"></i> KI Analyse
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-link"
                      [class.active]="activeTab === 'ocr'"
                      (click)="activeTab = 'ocr'">
                <i class="bi bi-text-paragraph me-2"></i> Original Text
              </button>
            </li>
          </ul>
        </div>

        <div class="card-body p-4 min-vh-50">

          <div *ngIf="activeTab === 'summary'" class="fade-in">
            <div *ngIf="document.summary; else noData">
              <h5 class="text-primary mb-3">Zusammenfassung</h5>
              <p class="lead fs-6 text-dark" style="line-height: 1.8; white-space: pre-wrap;">
                {{ document.summary }}
              </p>
            </div>
          </div>

          <div *ngIf="activeTab === 'ocr'" class="fade-in">
            <div *ngIf="document.content; else noData">
              <div class="bg-light p-3 rounded font-monospace small text-secondary" style="white-space: pre-wrap;">
                {{ document.content }}
              </div>
            </div>
          </div>

          <ng-template #noData>
            <div class="text-center py-5 text-muted">
              <i class="bi bi-hourglass-split fs-2 mb-2 d-block"></i>
              <p>Daten werden noch verarbeitet...</p>
            </div>
          </ng-template>

        </div>
      </div>
    </div>

  </div>
</div>
